(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{602:function(t,s,a){"use strict";a.r(s);var n=a(10),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[t._v("JavaScript是解释性语言，运行时是编译一行执行一行，但js并非上来就进入编译环节，它在编译之前存在预编译过程。预编译分为全局预编译（Global object GO）和函数预编译（activation object AO）。"),a("strong",[t._v("预编译会创建当前环境的执行期上下文。")])]),t._v(" "),a("h2",{attrs:{id:"_1-全局预编译"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-全局预编译"}},[t._v("#")]),t._v(" 1 全局预编译")]),t._v(" "),a("ol",[a("li",[t._v("创建GO对象（Global Object，全局执行期上下文，根据ECMAScript实现的宿主环境不同而不同，在浏览器中为window对象）；")]),t._v(" "),a("li",[t._v("变量声明,并赋值为underfined；")]),t._v(" "),a("li",[t._v("寻找函数声明，并赋值为函数变量体；")]),t._v(" "),a("li",[t._v("执行（执行的过程中才能赋值）")])]),t._v(" "),a("h2",{attrs:{id:"_2-函数预编译"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-函数预编译"}},[t._v("#")]),t._v(" 2 函数预编译")]),t._v(" "),a("ol",[a("li",[t._v("创建AO对象（Activate Object，函数执行期上下文）-> function（独立的空间）；")]),t._v(" "),a("li",[t._v("寻找形参和var变量声明，并将形参名和变量名作为AO的属性名，赋值为undefined；")]),t._v(" "),a("li",[t._v("形参和实参相统一，将实参的值赋给形参；")]),t._v(" "),a("li",[t._v("寻找函数内部的function函数声明，将函数名赋值给AO属性名，值为函数体；")]),t._v(" "),a("li",[t._v("执行函数。")])]),t._v(" "),a("p",[t._v("在函数执行期上下文中进行变量查找时，首先会在当前作用域的AO中查找，查找不到再在外部作用域的AO中查找，一直延续到全局执行环境，这个被称为作用域链。这里涉及到两个内容：作用域与作用域链和执行期上下文。")]),t._v(" "),a("p",[t._v("小测试：")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("a "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("test")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  a "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" a "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("test")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// undefined")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 3")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br")])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"title"},[t._v("提示")]),a("p",[t._v("GO= {a: undefined， 1；")]),t._v(" "),a("p",[t._v("​\t\t\ttest: function test(){...}")]),t._v(" "),a("p",[t._v("}")]),t._v(" "),a("p",[t._v("AO = {a:undefined，2, 3")]),t._v(" "),a("p",[t._v("由于A0中有a因此不用去GO中去找")]),t._v(" "),a("p",[t._v("}")])]),a("h2",{attrs:{id:"_3-作用域与作用域链"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-作用域与作用域链"}},[t._v("#")]),t._v(" 3 作用域与作用域链")]),t._v(" "),a("p",[t._v("作用域也分全局作用域和函数作用域。作用域就是一个独立的地盘，让变量不会外泄、暴露出去。也就是说作用域最大的用处就是隔离变量，不同作用域下同名变量不会有冲突。")]),t._v(" "),a("blockquote",[a("p",[t._v("ES6新增了块级作用域（在函数内部或"),a("code",[t._v("{}")]),t._v("包裹的代码块内部创建），在块级作用域内通过新增命令let和const声明变量，并且这些变量不会存在变量提升，也不允许重复声明。")])]),t._v(" "),a("p",[t._v("我们知道，函数也是一种对象类型，在对象内部，有些属性是我们无法访问的，这些是JS引擎内部固有的隐式属性。作用域中涉及到一个隐式属性为 "),a("code",[t._v("[[scope]]")]),t._v(" ，它是函数创建时生成的一个JS内部的隐式属性，是函数存储函数作用域链的容器，作用域链中则保存了AO/GO（执行期上下文）。")]),t._v(" "),a("p",[t._v("例子")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("a")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("b")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" b "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" a "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("b")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" c "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("a")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//a 定义： a.[[scope]] -> 0:GO")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//a 执行时时刻： a.[[scope]] -> 0：AO")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//\t\t\t\t\t\t\t\t\t\t\t\t\t1: GO")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//b 定义： b.[[scope]] -> 0：AO")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//\t\t\t\t\t\t\t\t\t\t\t\t1: GO")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//b 执行： b.[[scope]] -> 0：GO")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//\t\t\t\t\t\t\t\t\t\t\t\t1: AO(a)")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//\t\t\t\t\t\t\t\t\t\t\t\t2: GO")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//b 结束： b.[[scope]] -> 0：AO")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//\t\t\t\t\t\t\t\t\t\t\t\t1: GO")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//a 结束： a.[[scope]] -> 0：Go")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//\t\t\t\t\t\t\t\t\t\tb.[[scope]]✖️")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/Larrydu98/BlogIMage/main/image-20220404194901761.png",alt:"image-20220404194901761"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/Larrydu98/BlogIMage/main/image-20220404194918816.png",alt:"image-20220404194918816"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/Larrydu98/BlogIMage/main/image-20220404194932944.png",alt:"image-20220404194932944"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/Larrydu98/BlogIMage/main/image-20220404194944975.png",alt:"image-20220404194944975"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/Larrydu98/BlogIMage/main/image-20220404195013749.png",alt:"image-20220404195013749"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/Larrydu98/BlogIMage/main/image-20220404194901761.png",alt:"image-20220404194901761"}})]),t._v(" "),a("h2",{attrs:{id:"_4-执行上下文"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-执行上下文"}},[t._v("#")]),t._v(" 4 执行上下文")]),t._v(" "),a("h3",{attrs:{id:"_4-1-执行上下文分类"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-执行上下文分类"}},[t._v("#")]),t._v(" 4.1 执行上下文分类")]),t._v(" "),a("ol",[a("li",[a("p",[a("strong",[t._v("全局执行上下文")]),t._v("：  这是默认或者说基础的上下文，任何不在函数内部的代码都在全局上下文中。它会执行两件事：创建一个全局的 window 对象（浏览器的情况下），并且设置 "),a("code",[t._v("this")]),t._v(" 的值等于这个全局对象。一个程序中只会有一个全局执行上下文。")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("函数执行上下文")]),t._v(" ：每当一个函数被调用时, 都会为该函数创建一个新的上下文。每个函数都有它自己的执行上下文，不过是在函数被调用时创建的。函数上下文可以有任意多个。每当一个新的执行上下文被创建，它会按定义的顺序（将在后文讨论）执行一系列步骤，当韩式执行完毕时，一般情况下函数执行上下文会被销毁。")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"title"},[t._v("提示")]),a("p",[t._v("特殊情况就是闭包的情况")])])]),t._v(" "),a("li",[a("p",[t._v("eval执行上下文：当使用eval函数的时候，eval代码也会被编译，并创建执行上下文。")])])]),t._v(" "),a("h3",{attrs:{id:"_4-2-执行上下文内容"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-执行上下文内容"}},[t._v("#")]),t._v(" 4.2 执行上下文内容")]),t._v(" "),a("p",[t._v("在一个执行上下文中，最重要的三个属性分别是"),a("strong",[t._v("变量对象（Variable Object）")]),t._v("、"),a("strong",[t._v("作用域链（Scope Chain）"),a("strong",[t._v("和 this 指向。一个执行上下文的生命周期分为")]),t._v("创建")]),t._v("和"),a("strong",[t._v("执行")]),t._v("两个阶段：")]),t._v(" "),a("ul",[a("li",[t._v("创建阶段主要是生成变量对象（GO/AO），建立作用域链（scope chain）和确定this指向；")]),t._v(" "),a("li",[t._v("执行阶段主要工作是变量赋值和执行其他代码。")])]),t._v(" "),a("h3",{attrs:{id:"_4-3-代码执行过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-代码执行过程"}},[t._v("#")]),t._v(" 4.3 代码执行过程")]),t._v(" "),a("ul",[a("li",[t._v("创建 全局上下文 (global EC)。将其压入栈底；")]),t._v(" "),a("li",[t._v("全局执行上下文 (caller) 逐行 "),a("strong",[t._v("自上而下")]),t._v(" 执行。遇到函数时，函数执行上下文 (callee) 被push到执行栈顶层；")]),t._v(" "),a("li",[t._v("函数执行上下文被激活，成为 active EC, 开始执行函数中的代码，caller 被挂起；")]),t._v(" "),a("li",[t._v("函数执行完后，caller 被pop移除出执行栈，控制权交还全局上下文 (caller)，继续执行；")])]),t._v(" "),a("details",{staticClass:"custom-block details"},[a("summary",[t._v("参考文献")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://www.bilibili.com/video/BV1x441167iH",target:"_blank",rel:"noopener noreferrer"}},[t._v("JavaScript深度指南"),a("OutboundLink")],1)]),t._v(" "),a("p",[a("a",{attrs:{href:"https://juejin.cn/post/6844903682283143181",target:"_blank",rel:"noopener noreferrer"}},[t._v("理解 JavaScript 中的执行上下文和执行栈"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=e.exports}}]);